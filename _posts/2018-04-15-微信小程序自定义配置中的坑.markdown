---
layout:     post
title:      "微信小程序自定义配置中的坑"
subtitle:   " \"杂记\""
date:       2018-04-15
author:     "德鹏"
header-img: "img/bg/post-bg.jpg"
catalog: true
tags:
    - 微信小程序

---

> “nothing”

这两天我一直处于“龟息”状态，潜伏人世中。上周和这周周末都在进行挑战游泳5公里训练，按照我的游速，5公里需要在水里不间断地游近两个小时，只要游泳进入状态，就不再留意自己是否在游泳，脑子里面一直在想事，边游边想，以致于我忽然发现自己自由泳的状态跟走路一样。我不喜欢这种感觉，想早日解脱，回家。  

最近在弄微信小程序，腾讯目前给出来的指导不全，中间的坑不少，试着列举如下，供后来人参考：  

1. 微信小程序的生产环境，数据库上传限制为2M，比如我做的APP数据库比较大，有300多M，就没办法整，只能单独买服务器部署。  
2. 微信小程序的生产环境带宽为1M，这一点在购买时没有看到有提示。  
3. 我原来买过一个服务器，长时间闲置，准备启用。部署nginx时发现一直有问题，后来一想我在原来服务器上部署过apache，因此在部署nginx时，需要先检查环境。  
4. 这一点很重要。自己部署微信小程序的php demo时，给出的配置示例文件里面少一行，这一行会导致nginx服务器上报403 fobidden错误。微信小程序自己部署指导如下：  
https://cloud.tencent.com/document/product/619/12797   
在配置ngix和https部分，找到weapp.conf的示例文件，其中有一行为配置root目录的：  
root  /data/release/php-demo;  
在这一行下面再加一行：  
index index.php;  
此时使用nginx -s reload命令重启nginx服务器，这个时候403错误会变成502错误，表示网关错误。  
此时启动PHP后即会工作正常。  
service php-fpm start  

这两天状态不好，一点点弄，程序全部写完了，就等上线了。  
